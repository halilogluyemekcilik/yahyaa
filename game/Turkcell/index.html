<!DOCTYPE html>
<html lang="tr">

<head>
    <!-- 1) Kodlama ve g√∂r√ºn√ºm -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>√áark √áevir ‚Äì Dikey Ekran</title>
    <meta name="description" content="Dikey ekranda √ßark √ßevir oyunu ve animasyonlu arka plan.">

    <!-- 2) Tarayƒ±cƒ± farklarƒ±nƒ± azalt: normalize + temel reset -->
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet"> -->
    <link rel="stylesheet" href="https://unpkg.com/modern-normalize/modern-normalize.css">
    <style>
        *,
        *::before,
        *::after {
            box-sizing: border-box;
        }

        html,
        body {
            height: 100%;
        }

        body {
            margin: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        html {
            overscroll-behavior: none;
        }
    </style>

    <!-- 3) Mevcut stiller -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="arka.css">

    <!-- 4) Tema rengi / PWA (opsiyonel) -->
    <meta name="theme-color" content="#0f1115">
    <link rel="icon" href="./assets/center-logo.png" type="image/png">
    <link rel="apple-touch-icon" href="./assets/center-logo.png">
    <link rel="manifest" href="./manifest.webmanifest">

    <!-- 5) Polyfill (eski tarayƒ±cƒ±lar i√ßin gerekirse) -->
    <script>
        (function () {
            var needs = !('fetch' in window) || !('URLSearchParams' in window) || !('ResizeObserver' in window);
            if (needs) {
                var s = document.createElement('script');
                s.src = 'https://cdn.polyfill.io/v3/polyfill.min.js?features=default,fetch,URL,URLSearchParams,ResizeObserver';
                s.defer = true;
                document.head.appendChild(s);
            }
        })();
    </script>

    <!-- 6) K√º√ß√ºk yardƒ±mcƒ±lar -->
    <script>
        window.normalizeWheelDelta = function (e) { return e.deltaY * (e.deltaMode === 1 ? 16 : 1); };
        try { window.addEventListener('test', null, Object.defineProperty({}, 'passive', { get: () => { } })); } catch (e) { }
    </script>
</head>

<body class="settings-hidden">
    <!-- ARKA PLAN KATMANI (tam ekran, etkile≈üimsiz) -->
    <div id="arka-root" aria-hidden="true">
        <div id="arka-stage"></div>
    </div>

    <!-- Sitenin kendi i√ßerikleri -->
    <!-- Sesler -->
    <audio id="bgMusic" preload="auto" loop>
        <source src="./assets/bg-music.mp3" type="audio/mpeg">
    </audio>
    <audio id="spinSfx" preload="auto">
        <source src="./assets/spin-sfx.mp3" type="audio/mpeg">
    </audio>
    <audio id="tickSfx" preload="auto">
        <source src="./assets/tick.mp3" type="audio/mpeg">
    </audio>

    <div class="wrap">
        <div class="card" role="application" aria-label="√áark √áevirme Oyunu">
            <div class="header" style="justify-content: space-between; gap: 10px;">
                <div></div>
                <button id="installBtn" class="btn primary" style="display:none">Uygulamayƒ± Y√ºkle</button>
            </div>

            <div class="stage" id="wheelStage">
                <button id="settingsBtn" class="settings-btn" aria-haspopup="true" aria-expanded="false"
                    aria-controls="settingsPanel">‚öôÔ∏è</button>

                <div id="settingsPanel" class="settings-panel" role="menu" aria-label="Ayarlar">
                    <h3>Ayarlar</h3>
                    <div class="settings-row">
                        <span>Genel Ses</span>
                        <input type="range" id="masterVolume" min="0" max="100" value="80" />
                    </div>
                    <div class="settings-row">
                        <span>Arkaplan M√ºzik</span>
                        <label><input type="checkbox" id="musicToggle" checked /> A√ßƒ±k</label>
                    </div>
                    <div class="settings-row">
                        <span>Otomatik Kapanma</span>
                        <label><input type="checkbox" id="autoCloseToggle" /> A√ßƒ±k</label>
                    </div>
                    <div class="settings-row">
                        <span>Tam Ekran</span>
                        <button class="btn-inline" id="fsToggle">A√ß/Kapat</button>
                    </div>
                </div>

                <div id="pointer" class="pointer pointerEl" role="button" aria-label="√áarkƒ± D√∂nd√ºr" tabindex="0"></div>
                <canvas id="wheel" aria-label="√áark"></canvas>

                <div class="center-wrap" aria-hidden="false">
                    <div class="hub" aria-hidden="true">
                        <!-- Ortadaki LOGO = D√∂nd√ºr butonu -->
                        <button id="spinBtn" class="spin-img" aria-label="√áarkƒ± D√∂nd√ºr">
                            <img src="" alt="" draggable="false" />
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sonu√ß Modalƒ± -->
    <div class="modal" id="resultModal" role="dialog" aria-modal="true" aria-labelledby="resultTitle"
        aria-describedby="resultDesc">
        <div class="modal-card">
            <div style="font-size:40px" aria-hidden="true">üéâ</div>
            <h2 id="resultTitle">Tebrikler!</h2>
            <div id="resultDesc" class="prize">√ñd√ºl</div>
            <div class="actions">
                <button class="btn" id="closeModal">Kapat</button>
            </div>
            <div id="autoCloseContainer" class="auto-close" aria-hidden="true">
                <div class="bar-bg">
                    <div class="bar-fill" id="autoCloseFill"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Mevcut sitenin script'i -->
    <script defer src="script.js"></script>

    <!-- ARKA PLAN script'i (ayrƒ± dosya) -->
    <script defer src="arka.js"></script>

    <!-- Service Worker Kayƒ±t -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', function () {
                navigator.serviceWorker.register('./service-worker.js').catch(function () { });
            });
        }
        // Basit indir-kopyala korumasƒ± (kolayca a≈üƒ±labilir)
        window.addEventListener('contextmenu', function (e) { e.preventDefault(); });
        window.addEventListener('keydown', function (e) {
            if ((e.ctrlKey || e.metaKey) && (e.key === 's' || e.key === 'p' || e.key === 'u')) { e.preventDefault(); }
        });
    </script>
</body>

</html>